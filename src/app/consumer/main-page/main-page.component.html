<body [ngClass]="{'sidebar-main': changeMenu}" class="line-height">

   <div class="wrapper">
      <app-side-navbar (clicked)="recevoirMessage($event)"></app-side-navbar>

      <app-top-nav-bar [bodyClass]="{'sidebar-main': changeMenu}" />
      <!-- Page Content  -->
      <div id="content-page" class="content-page">
         <div class="container-fluid">
            <div class="row">
               <div class="col-sm-6 col-md-6 col-lg-3">
                  <div class="iq-card iq-card-block iq-card-stretch iq-card-height">
                     <div class="iq-card-body iq-box-relative">
                        <div class="iq-box-absolute icon iq-icon-box rounded-circle iq-bg-primary">
                           <i class="iq-arrow-left ri-money-dollar-box-line"></i>
                        </div>
                        <p class="text-secondary">Total Expenses</p>
                        <div class="d-flex align-items-center justify-content-between">
                           <h4><b>{{this.dashboardData.totalExpenses}}</b></h4>
                           <div id="iq-chart-box1"></div>
                           <span class="text-primary"><b> +14% <i class="ri-arrow-up-fill"></i></b></span>
                        </div>
                     </div>
                  </div>
               </div>
               <div class="col-sm-6 col-md-6 col-lg-3">
                  <div class="iq-card iq-card-block iq-card-stretch iq-card-height">
                     <div class="iq-card-body iq-box-relative">
                        <div class="iq-box-absolute icon iq-icon-box rounded-circle iq-bg-danger">
                           <i class="iq-arrow-left ri-wallet-3-line"></i>
                        </div>
                        <p class="text-secondary">Total Budgets</p>
                        <div class="d-flex align-items-center justify-content-between">
                           <h4><b>{{this.dashboardData.totalBudget}}</b></h4>
                           <div id="iq-chart-box2"></div>
                           <span class="text-danger"><b> -6% <i class="ri-arrow-down-fill"></i></b></span>
                        </div>
                     </div>
                  </div>
               </div>
               <div class="col-sm-6 col-md-6 col-lg-3">
                  <div class="iq-card iq-card-block iq-card-stretch iq-card-height">
                     <div class="iq-card-body iq-box-relative">
                        <div class="iq-box-absolute icon iq-icon-box rounded-circle iq-bg-success">
                           <i class="fa-solid fa-money-bill-trend-up"></i>
                        </div>
                        <p class="text-secondary">Budget left</p>
                        <div class="d-flex align-items-center justify-content-between">
                           <h4><b>{{this.dashboardData.budgetLeft}}</b></h4>
                           <div id="iq-chart-box3"></div>
                           <span class="text-success"><b> +0.36% <i class="ri-arrow-up-fill"></i></b></span>
                        </div>
                     </div>
                  </div>
               </div>
               <div class="col-sm-6 col-md-6 col-lg-3">
                  <div class="iq-card iq-card-block iq-card-stretch iq-card-height">
                     <div class="iq-card-body iq-box-relative">
                        <div class="iq-box-absolute icon iq-icon-box rounded-circle iq-bg-warning">
                           <i class="ri-pie-chart-2-line"></i>
                        </div>
                        <p class="text-secondary">Total Profit</p>
                        <div class="d-flex align-items-center justify-content-between">
                           <h4><b>60</b></h4>
                           <div id="iq-chart-box4"></div>
                           <span class="text-warning"><b> +0.45% <i class="ri-arrow-up-fill"></i></b></span>
                        </div>
                     </div>
                  </div>
               </div>
               <div class="col-lg-8">
                  <div class="iq-card iq-card-block iq-card-stretch iq-card-height">
                     <div class="iq-card-header d-flex justify-content-between">
                        <div class="iq-header-title">
                           <h4 class="card-title">
                              Expenses : {{ selectedCategory }} </h4>
                        </div>
                        <div class="iq-card-header-toolbar d-flex align-items-center">
                           <ul class="nav nav-pills">
                              <li class="nav-item">
                                 <label for="start">Date d√©but</label>
                                 <input type="date" [(ngModel)]="startDate" (change)="updateChart()" name="start"
                                    id="start" required>
                              </li>
                              <li class="nav-item">
                                 <label for="end">Date fin</label>
                                 <input type="date" [(ngModel)]="endDate" (change)="updateChart()" name="end" id="end"
                                    required>
                              </li>
                              <li class="nav-item">
                                 <select [(ngModel)]="selectedCategory" name="category" id="category"
                                    (change)="updateChart()" required>
                                    <option *ngFor="let cat of categories" [value]="cat">{{ cat }}</option>
                                 </select>
                              </li>
                           </ul>
                        </div>
                     </div>
                     <div class="iq-card-body row m-0 align-items-center pb-0">
                        <div class="col-md-8">
                           <div id="iq-income-chart">

                              <ag-charts [options]="lineChartOptions"></ag-charts>
                           </div>
                        </div>
                        <div class="col-md-4">
                           <div class="chart-data-block">
                              <h4><b>Total</b></h4>
                              <h2><b>{{TotalExpenseByCategoryInPeriod}} </b></h2>
                              <p>Total Expense in selected Period</p>
                              <div class="chart-box d-flex align-items-center justify-content-between mt-5 mb-5">
                                 <div id="iq-chart-boxleft"></div>
                                 <div id="iq-chart-boxright"></div>
                              </div>
                              <div class="mt-3 pr-3">
                                 <div class="d-flex align-items-center justify-content-between">
                                    <div class="d-flex align-items-center">
                                       <span
                                         class="rounded-circle mr-2"
                                         style="background-color:#5090dc; width: 8px; height: 8px; display: inline-block;"
                                       ></span>
                                       <p class="mb-0">Amount Spent</p>
                                     </div>
                                     
                                    
                                 </div>
                                 
                              </div>
                           </div>
                        </div>
                     </div>
                  </div>
               </div>
               <div class="col-lg-4">
                  <div
                     class="iq-card iq-card-block iq-card-stretch iq-card-height banner-image-block-bg position-relative">
                     <ag-charts [options]="donutChartOptions"></ag-charts>

                  </div>
               </div>
               <div class="col-lg-8">
                  <div class="iq-card iq-card-block iq-card-stretch iq-card-height">
                     <div class="iq-card-header d-flex justify-content-between">
                        <div class="iq-header-title">
                           <h4 class="card-title">Last Expenses</h4>
                        </div>
                        <div class="iq-card-header-toolbar d-flex align-items-center">
                           <div class="dropdown">
                              <span class="dropdown-toggle text-primary" id="dropdownMenuButton5"
                                 data-toggle="dropdown">
                                 <i class="ri-more-fill"></i>
                              </span>
                              <div class="dropdown-menu dropdown-menu-right" aria-labelledby="dropdownMenuButton5">
                                 <a class="dropdown-item" href="#"><i class="ri-eye-fill mr-2"></i>View</a>
                                 <a class="dropdown-item" href="#"><i class="ri-delete-bin-6-fill mr-2"></i>Delete</a>
                                 <a class="dropdown-item" href="#"><i class="ri-pencil-fill mr-2"></i>Edit</a>
                                 <a class="dropdown-item" href="#"><i class="ri-printer-fill mr-2"></i>Print</a>
                                 <a class="dropdown-item" href="#"><i
                                       class="ri-file-download-fill mr-2"></i>Download</a>
                              </div>
                           </div>
                        </div>
                     </div>
                     <div class="iq-card-body">
                        <div class="table-responsive">




                           <p-table #dt [value]="recentExpenses" sortMode="multiple">
                              <ng-template pTemplate="header">
                                 <tr>
                                    <th pSortableColumn="name">
                                       name <p-sortIcon field="name" />
                                    </th>
                                    <th pSortableColumn="date">
                                       date <p-sortIcon field="date" />
                                    </th>
                                    <th pSortableColumn="categoryName">
                                       categoryName <p-sortIcon field="categoryName" />
                                    </th>
                                    <th pSortableColumn="amount">
                                       amount <p-sortIcon field="amount" />
                                    </th>
                                 </tr>
                              </ng-template>
                              <ng-template pTemplate="body" let-expense>
                                 <tr>
                                    <td>{{ expense.name }}</td>
                                    <td>{{ expense.date }}</td>
                                    <td>{{ expense.categoryName }}</td>
                                    <td>{{ expense.amount }}</td>
                                 </tr>
                              </ng-template>
                           </p-table>






                        </div>
                     </div>
                  </div>
               </div>
               <div class="col-lg-4">
                  <div class="iq-card iq-card-block iq-card-stretch iq-card-height">
                     <div class="iq-card-body">


                        <div *ngFor="let budget of budgets" class="d-flex align-items-center mt-3">
                           <div class="icon iq-icon-box rounded iq-bg-danger mr-3">
                              <i [class]="getCategoryIconClass(budget.categoryName)"
                                 [ngStyle]="{ color: getIconColor(budget.categoryName) }"></i>

                           </div>
                           <div class="iq-details col-sm-9 p-0">
                              <div class="d-flex align-items-center justify-content-between">
                                 <span class="title text-dark">{{ budget.categoryName }} Budget</span>
                                 <div class="percentage"><b><span>{{ budget.limitValue }} </span> Dnt</b></div>
                              </div>
                              <div class="iq-progress-bar-linear d-inline-block w-100">
                                 <div class="iq-progress-bar">
                                    <span class="bg-danger"
                                       [style.width.%]="budget.percentageSpent > 100 ? 100 : budget.percentageSpent"></span>
                                 </div>
                              </div>
                              <div class="d-flex align-items-center justify-content-between">
                                 <span class="">Pourcentage Spent</span>
                                 <div class="percentage">{{ budget.percentageSpent | number:'1.2-2' }}<span>%</span>
                                 </div>
                              </div>
                           </div>
                        </div>




                     </div>
                  </div>
               </div>
            </div>
         </div>
      </div>
   </div>
   <!-- Wrapper END -->
   <app-footer />


</body>